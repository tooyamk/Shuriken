srkSetSubProject("")
set(OUTPUT_NAME_PREFIX ${CMAKE_STATIC_LIBRARY_PREFIX}astcenc-)
set(OUTPUT_NAME_SUFFIX -static)
set(OUTPUT_NAME_NONE ${OUTPUT_NAME_PREFIX}none${OUTPUT_NAME_SUFFIX})
set(OUTPUT_NAME_SSE2 ${OUTPUT_NAME_PREFIX}sse2${OUTPUT_NAME_SUFFIX})
#set(OUTPUT_NAME_SSE4 ${OUTPUT_NAME_PREFIX}sse4${OUTPUT_NAME_SUFFIX})
#set(OUTPUT_NAME_AVX2 ${OUTPUT_NAME_PREFIX}avx2${OUTPUT_NAME_SUFFIX})
set(OUTPUT_NAME_NEON ${OUTPUT_NAME_PREFIX}neon${OUTPUT_NAME_SUFFIX})
set(SLIB_PREFIX_NONE ${PROJECT_BINARY_DIR}/install/lib/${OUTPUT_NAME_NONE})
set(SLIB_PREFIX_SSE2 ${PROJECT_BINARY_DIR}/install/lib/${OUTPUT_NAME_SSE2})
#set(SLIB_PREFIX_SSE4 ${PROJECT_BINARY_DIR}/install/lib/${OUTPUT_NAME_SSE4})
#set(SLIB_PREFIX_AVX2 ${PROJECT_BINARY_DIR}/install/lib/${OUTPUT_NAME_AVX2})
set(SLIB_PREFIX_NEON ${PROJECT_BINARY_DIR}/install/lib/${OUTPUT_NAME_NEON})
set(SLIB_NONE_R ${SLIB_PREFIX_NONE}${CMAKE_RELEASE_POSTFIX}${SRK_SLIB_SUFFIX})
set(SLIB_NONE_D ${SLIB_PREFIX_NONE}${CMAKE_DEBUG_POSTFIX}${SRK_SLIB_SUFFIX})
set(SLIB_SSE2_R ${SLIB_PREFIX_SSE2}${CMAKE_RELEASE_POSTFIX}${SRK_SLIB_SUFFIX})
set(SLIB_SSE2_D ${SLIB_PREFIX_SSE2}${CMAKE_DEBUG_POSTFIX}${SRK_SLIB_SUFFIX})
#set(SLIB_SSE4_R ${SLIB_PREFIX_SSE4}${CMAKE_RELEASE_POSTFIX}${SRK_SLIB_SUFFIX})
#set(SLIB_SSE4_D ${SLIB_PREFIX_SSE4}${CMAKE_DEBUG_POSTFIX}${SRK_SLIB_SUFFIX})
#set(SLIB_AVX2_R ${SLIB_PREFIX_AVX2}${CMAKE_RELEASE_POSTFIX}${SRK_SLIB_SUFFIX})
#set(SLIB_AVX2_D ${SLIB_PREFIX_AVX2}${CMAKE_DEBUG_POSTFIX}${SRK_SLIB_SUFFIX})
set(SLIB_NEON_R ${SLIB_PREFIX_NEON}${CMAKE_RELEASE_POSTFIX}${SRK_SLIB_SUFFIX})
set(SLIB_NEON_D ${SLIB_PREFIX_NEON}${CMAKE_DEBUG_POSTFIX}${SRK_SLIB_SUFFIX})

set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_NAME ${PROJECT_NAME})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_INCLUDE ${PROJECT_BINARY_DIR}/src/Source)
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_NONE_SLIB ${SLIB_PREFIX_NONE}${SRK_BUILD_TYPE_SUFFIX}${SRK_SLIB_SUFFIX})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_SSE2_SLIB ${SLIB_PREFIX_SSE2}${SRK_BUILD_TYPE_SUFFIX}${SRK_SLIB_SUFFIX})
#set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_SSE4_SLIB ${SLIB_PREFIX_SSE4}${SRK_BUILD_TYPE_SUFFIX}${SRK_SLIB_SUFFIX})
#set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_AVX2_SLIB ${SLIB_PREFIX_AVX2}${SRK_BUILD_TYPE_SUFFIX}${SRK_SLIB_SUFFIX})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_NEON_SLIB ${SLIB_PREFIX_NEON}${SRK_BUILD_TYPE_SUFFIX}${SRK_SLIB_SUFFIX})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_NONE_SLIB_R ${SLIB_NONE_R})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_NONE_SLIB_D ${SLIB_NONE_D})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_SSE2_SLIB_R ${SLIB_SSE2_R})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_SSE2_SLIB_D ${SLIB_SSE2_D})
#set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_SSE4_SLIB_R ${SLIB_SSE4_R})
#set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_SSE4_SLIB_D ${SLIB_SSE4_D})
#set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_AVX2_SLIB_R ${SLIB_AVX2_R})
#set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_AVX2_SLIB_D ${SLIB_AVX2_D})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_NEON_SLIB_R ${SLIB_NEON_R})
set_property(GLOBAL PROPERTY SRKPROJ_EXTERNAL_ASTC_ENCODER_NEON_SLIB_D ${SLIB_NEON_D})

include(ExternalProject)

srkCreateExternalProjectCmakeArgs(cmakeArgs)

if (SRK_ARCH_X86)
    set(args
        -DISA_SSE2=ON
        -DISA_AVX2=OFF
        -DISA_SSE41=OFF
        -DISA_NEON=OFF
    )
elseif (SRK_ARCH_ARM AND SRK_ARCH_WORD_BITS_64)
    set(args
        -DISA_SSE2=OFF
        -DISA_AVX2=OFF
        -DISA_SSE41=OFF
        -DISA_NEON=ON
    )
endif ()

ExternalProject_Add(
    ${PROJECT_NAME}
    PREFIX ${PROJECT_BINARY_DIR}
    GIT_REPOSITORY https://github.com/ARM-software/astc-encoder.git
    GIT_TAG 4.1.0
    GIT_SHALLOW 1
    GIT_PROGRESS 1
    TMP_DIR tmp
    STAMP_DIR stamp
    DOWNLOAD_DIR download
    INSTALL_DIR install
    SOURCE_DIR src
    BINARY_DIR ${SRK_PROJECT_BUILD_ROOT_DIR}
    UPDATE_COMMAND ""
    PATCH_COMMAND
        ${CMAKE_COMMAND}
        -DSRC_DIR=${PROJECT_BINARY_DIR}/src
        -P ${CMAKE_CURRENT_SOURCE_DIR}/patch.cmake
    BUILD_BYPRODUCTS 
        ${LIB_NONE_R}
        ${LIB_NONE_D}
        ${LIB_SSE2_R}
        ${LIB_SSE2_D}
        ${LIB_NEON_R}
        ${LIB_NEON_D}
    CMAKE_ARGS
        -DISA_NONE=ON
        -DUNITTEST=OFF
        -DDIAGNOSTICS=OFF
        -DCLI=OFF
        -DCMAKE_INSTALL_PREFIX=../install
        ${args}
        ${cmakeArgs}
)

set_property(TARGET ${PROJECT_NAME} PROPERTY FOLDER ${SRK_EXTERNAL_DIR_NAME})